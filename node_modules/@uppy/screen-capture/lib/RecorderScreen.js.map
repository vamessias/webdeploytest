{"version":3,"names":["h","Component","RecordButton","SubmitButton","StopWatch","StreamStatus","RecorderScreen","constructor","arguments","videoElement","componentWillUnmount","onStop","props","render","recording","stream","videoStream","recordedVideo","videoProps","playsinline","muted","autoplay","srcObject","controls","src","className","_extends","ref"],"sources":["RecorderScreen.tsx"],"sourcesContent":["/* eslint-disable react/jsx-props-no-spreading */\nimport { h, Component, type ComponentChild } from 'preact'\nimport type { Body, Meta } from '@uppy/utils/lib/UppyFile'\nimport RecordButton from './RecordButton.tsx'\nimport SubmitButton from './SubmitButton.tsx'\nimport StopWatch from './StopWatch.tsx'\nimport StreamStatus from './StreamStatus.tsx'\n\nimport ScreenCapture, { type ScreenCaptureState } from './ScreenCapture.tsx'\n\ntype RecorderScreenProps<M extends Meta, B extends Body> = {\n  onStartRecording: ScreenCapture<M, B>['startRecording']\n  onStopRecording: ScreenCapture<M, B>['stopRecording']\n  onStop: ScreenCapture<M, B>['stop']\n  onSubmit: ScreenCapture<M, B>['submit']\n  i18n: ScreenCapture<M, B>['i18n']\n  stream: ScreenCapture<M, B>['videoStream']\n} & ScreenCaptureState\n\nclass RecorderScreen<M extends Meta, B extends Body> extends Component<\n  RecorderScreenProps<M, B>\n> {\n  videoElement: HTMLVideoElement | null = null\n\n  componentWillUnmount(): void {\n    const { onStop } = this.props\n    onStop()\n  }\n\n  render(): ComponentChild {\n    const { recording, stream: videoStream, recordedVideo } = this.props\n\n    const videoProps: {\n      muted?: boolean\n      autoplay?: boolean\n      playsinline?: boolean\n      controls?: boolean\n      src?: string\n      srcObject?: MediaStream | null\n    } = {\n      playsinline: true,\n    }\n\n    // show stream\n    if (recording || (!recordedVideo && !recording)) {\n      videoProps.muted = true\n      videoProps.autoplay = true\n      videoProps.srcObject = videoStream\n    }\n\n    // show preview\n    if (recordedVideo && !recording) {\n      videoProps.muted = false\n      videoProps.controls = true\n      videoProps.src = recordedVideo\n\n      // reset srcObject in dom. If not resetted, stream sticks in element\n      if (this.videoElement) {\n        this.videoElement.srcObject = null\n      }\n    }\n\n    return (\n      <div className=\"uppy uppy-ScreenCapture-container\">\n        <div className=\"uppy-ScreenCapture-videoContainer\">\n          <StreamStatus {...this.props} />\n          {/* eslint-disable-next-line jsx-a11y/media-has-caption */}\n          <video\n            ref={(videoElement) => {\n              this.videoElement = videoElement\n            }}\n            className=\"uppy-ScreenCapture-video\"\n            {...videoProps}\n          />\n          <StopWatch {...this.props} />\n        </div>\n\n        <div className=\"uppy-ScreenCapture-buttonContainer\">\n          <RecordButton {...this.props} />\n          <SubmitButton {...this.props} />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default RecorderScreen\n"],"mappings":";AAAA;AACA,SAASA,CAAC,EAAEC,SAAS,QAA6B,QAAQ;AAE1D,OAAOC,YAAY,MAAM,mBAAoB;AAC7C,OAAOC,YAAY,MAAM,mBAAoB;AAC7C,OAAOC,SAAS,MAAM,gBAAiB;AACvC,OAAOC,YAAY,MAAM,mBAAoB;AAa7C,MAAMC,cAAc,SAAyCL,SAAS,CAEpE;EAAAM,YAAA;IAAA,SAAAC,SAAA;IAAA,KACAC,YAAY,GAA4B,IAAI;EAAA;EAE5CC,oBAAoBA,CAAA,EAAS;IAC3B,MAAM;MAAEC;IAAO,CAAC,GAAG,IAAI,CAACC,KAAK;IAC7BD,MAAM,CAAC,CAAC;EACV;EAEAE,MAAMA,CAAA,EAAmB;IACvB,MAAM;MAAEC,SAAS;MAAEC,MAAM,EAAEC,WAAW;MAAEC;IAAc,CAAC,GAAG,IAAI,CAACL,KAAK;IAEpE,MAAMM,UAOL,GAAG;MACFC,WAAW,EAAE;IACf,CAAC;;IAED;IACA,IAAIL,SAAS,IAAK,CAACG,aAAa,IAAI,CAACH,SAAU,EAAE;MAC/CI,UAAU,CAACE,KAAK,GAAG,IAAI;MACvBF,UAAU,CAACG,QAAQ,GAAG,IAAI;MAC1BH,UAAU,CAACI,SAAS,GAAGN,WAAW;IACpC;;IAEA;IACA,IAAIC,aAAa,IAAI,CAACH,SAAS,EAAE;MAC/BI,UAAU,CAACE,KAAK,GAAG,KAAK;MACxBF,UAAU,CAACK,QAAQ,GAAG,IAAI;MAC1BL,UAAU,CAACM,GAAG,GAAGP,aAAa;;MAE9B;MACA,IAAI,IAAI,CAACR,YAAY,EAAE;QACrB,IAAI,CAACA,YAAY,CAACa,SAAS,GAAG,IAAI;MACpC;IACF;IAEA,OACEtB,CAAA;MAAKyB,SAAS,EAAC;IAAmC,GAChDzB,CAAA;MAAKyB,SAAS,EAAC;IAAmC,GAChDzB,CAAA,CAACK,YAAY,EAAK,IAAI,CAACO,KAAQ,CAAC,EAEhCZ,CAAA,UAAA0B,QAAA;MACEC,GAAG,EAAGlB,YAAY,IAAK;QACrB,IAAI,CAACA,YAAY,GAAGA,YAAY;MAClC,CAAE;MACFgB,SAAS,EAAC;IAA0B,GAChCP,UAAU,CACf,CAAC,EACFlB,CAAA,CAACI,SAAS,EAAK,IAAI,CAACQ,KAAQ,CACzB,CAAC,EAENZ,CAAA;MAAKyB,SAAS,EAAC;IAAoC,GACjDzB,CAAA,CAACE,YAAY,EAAK,IAAI,CAACU,KAAQ,CAAC,EAChCZ,CAAA,CAACG,YAAY,EAAK,IAAI,CAACS,KAAQ,CAC5B,CACF,CAAC;EAEV;AACF;AAEA,eAAeN,cAAc","ignoreList":[]}
{"version":3,"names":["UIPlugin","packageJson","ReduxDevTools","constructor","uppy","opts","type","id","title","defaultOptions","handleStateChange","bind","initDevTools","prevState","nextState","devTools","send","window","devToolsExtension","connect","devToolsUnsubscribe","subscribe","message","payload","cancelAll","computedStates","nextLiftedState","store","state","getState","length","updateAll","JSON","parse","install","withDevTools","__REDUX_DEVTOOLS_EXTENSION__","on","uninstall","off","handleStateUpdate","VERSION","version"],"sources":["index.js"],"sourcesContent":["import { UIPlugin } from '@uppy/core'\n\nimport packageJson from '../package.json'\n\n/* eslint-disable max-len */\n/**\n * Add Redux DevTools support to Uppy\n *\n * See https://medium.com/@zalmoxis/redux-devtools-without-redux-or-how-to-have-a-predictable-state-with-any-architecture-61c5f5a7716f\n * and https://github.com/zalmoxisus/mobx-remotedev/blob/master/src/monitorActions.js\n */\n/* eslint-enable max-len */\nexport default class ReduxDevTools extends UIPlugin {\n  static VERSION = packageJson.version\n\n  constructor (uppy, opts) {\n    super(uppy, opts)\n    this.type = 'debugger'\n    this.id = this.opts.id || 'ReduxDevTools'\n    this.title = 'Redux DevTools'\n\n    // set default options\n    const defaultOptions = {}\n\n    // merge default options with the ones set by user\n    this.opts = { ...defaultOptions, ...opts }\n\n    this.handleStateChange = this.handleStateChange.bind(this)\n    this.initDevTools = this.initDevTools.bind(this)\n  }\n\n  handleStateChange (prevState, nextState) {\n    this.devTools.send('UPPY_STATE_UPDATE', nextState)\n  }\n\n  initDevTools () {\n    this.devTools = window.devToolsExtension.connect()\n    this.devToolsUnsubscribe = this.devTools.subscribe((message) => {\n      if (message.type === 'DISPATCH') {\n        // Implement monitors actions\n        switch (message.payload.type) {\n          case 'RESET':\n            this.uppy.cancelAll()\n            return\n          case 'IMPORT_STATE': {\n            const { computedStates } = message.payload.nextLiftedState\n            this.uppy.store.state = { ...this.uppy.getState(), ...computedStates[computedStates.length - 1].state }\n            this.uppy.updateAll(this.uppy.getState())\n            return\n          }\n          case 'JUMP_TO_STATE':\n          case 'JUMP_TO_ACTION':\n            this.uppy.store.state = { ...this.uppy.getState(), ...JSON.parse(message.state) }\n            this.uppy.updateAll(this.uppy.getState())\n            break\n\n          default:\n        }\n      }\n    })\n  }\n\n  install () {\n    // eslint-disable-next-line no-underscore-dangle\n    this.withDevTools = typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION__\n    if (this.withDevTools) {\n      this.initDevTools()\n      this.uppy.on('state-update', this.handleStateChange)\n    }\n  }\n\n  uninstall () {\n    if (this.withDevTools) {\n      this.devToolsUnsubscribe()\n      this.uppy.off('state-update', this.handleStateUpdate)\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]}
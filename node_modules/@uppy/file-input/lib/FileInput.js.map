{"version":3,"names":["h","UIPlugin","toArray","packageJson","locale","defaultOptions","pretty","inputName","FileInput","constructor","uppy","opts","input","id","title","type","defaultLocale","i18nInit","render","bind","handleInputChange","handleClick","addFiles","files","descriptors","map","file","source","name","data","err","log","event","currentTarget","value","click","_restrictions$allowed","hiddenInputStyle","width","height","opacity","overflow","position","zIndex","restrictions","className","style","undefined","onChange","multiple","maxNumberOfFiles","accept","allowedFileTypes","join","ref","onClick","i18n","install","target","mount","uninstall","unmount","VERSION","version"],"sources":["FileInput.tsx"],"sourcesContent":["import { h, type ComponentChild } from 'preact'\n\nimport { UIPlugin, Uppy, type UIPluginOptions } from '@uppy/core'\nimport toArray from '@uppy/utils/lib/toArray'\nimport type { Body, Meta } from '@uppy/utils/lib/UppyFile'\nimport type { DefinePluginOpts } from '@uppy/core/lib/BasePlugin.js'\nimport type { TargetedEvent } from 'preact/compat'\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore We don't want TS to generate types for the package.json\nimport packageJson from '../package.json'\nimport locale from './locale.ts'\n\nexport interface FileInputOptions extends UIPluginOptions {\n  pretty?: boolean\n  inputName?: string\n}\nconst defaultOptions = {\n  pretty: true,\n  inputName: 'files[]',\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/files\ninterface HTMLFileInputElement extends HTMLInputElement {\n  files: FileList\n}\n\ntype Opts = DefinePluginOpts<FileInputOptions, keyof typeof defaultOptions>\n\nexport default class FileInput<M extends Meta, B extends Body> extends UIPlugin<\n  Opts,\n  M,\n  B\n> {\n  static VERSION = packageJson.version\n\n  input: HTMLFileInputElement | null = null\n\n  constructor(uppy: Uppy<M, B>, opts?: FileInputOptions) {\n    super(uppy, { ...defaultOptions, ...opts })\n    this.id = this.opts.id || 'FileInput'\n    this.title = 'File Input'\n    this.type = 'acquirer'\n\n    this.defaultLocale = locale\n\n    this.i18nInit()\n\n    this.render = this.render.bind(this)\n    this.handleInputChange = this.handleInputChange.bind(this)\n    this.handleClick = this.handleClick.bind(this)\n  }\n\n  addFiles(files: File[]): void {\n    const descriptors = files.map((file) => ({\n      source: this.id,\n      name: file.name,\n      type: file.type,\n      data: file,\n    }))\n\n    try {\n      this.uppy.addFiles(descriptors)\n    } catch (err) {\n      this.uppy.log(err)\n    }\n  }\n\n  private handleInputChange(event: TargetedEvent<HTMLInputElement, Event>) {\n    this.uppy.log('[FileInput] Something selected through input...')\n    const files = toArray(event.currentTarget.files || [])\n    this.addFiles(files)\n\n    // Clear the input so that Chrome can detect file section when the same file is repeatedly selected\n    // (see https://github.com/transloadit/uppy/issues/768#issuecomment-2264902758)\n    // eslint-disable-next-line no-param-reassign\n    event.currentTarget.value = ''\n  }\n\n  private handleClick() {\n    this.input!.click()\n  }\n\n  render(): ComponentChild {\n    /* http://tympanus.net/codrops/2015/09/15/styling-customizing-file-inputs-smart-way/ */\n    const hiddenInputStyle = {\n      width: '0.1px',\n      height: '0.1px',\n      opacity: 0,\n      overflow: 'hidden',\n      position: 'absolute',\n      zIndex: -1,\n    } satisfies h.JSX.IntrinsicElements['input']['style']\n\n    const { restrictions } = this.uppy.opts\n\n    return (\n      <div className=\"uppy-FileInput-container\">\n        <input\n          className=\"uppy-FileInput-input\"\n          style={this.opts.pretty ? hiddenInputStyle : undefined}\n          type=\"file\"\n          name={this.opts.inputName}\n          onChange={this.handleInputChange}\n          multiple={restrictions.maxNumberOfFiles !== 1}\n          accept={restrictions.allowedFileTypes?.join(', ')}\n          ref={(input) => {\n            this.input = input as HTMLFileInputElement\n          }}\n        />\n        {this.opts.pretty && (\n          <button\n            className=\"uppy-FileInput-btn\"\n            type=\"button\"\n            onClick={this.handleClick}\n          >\n            {this.i18n('chooseFiles')}\n          </button>\n        )}\n      </div>\n    )\n  }\n\n  install(): void {\n    const { target } = this.opts\n    if (target) {\n      this.mount(target, this)\n    }\n  }\n\n  uninstall(): void {\n    this.unmount()\n  }\n}\n"],"mappings":"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","ignoreList":[]}
{"version":3,"names":["Cropper","h","Component","getCanvasDataThatFitsPerfectlyIntoContainer","getScaleFactorThatRemovesDarkCorners","limitCropboxMovementOnMove","limitCropboxMovementOnResize","Editor","constructor","props","onRotate90Deg","angle90Deg","state","newAngle","setState","angleGranular","cropper","scale","rotateTo","canvasData","getCanvasData","containerData","getContainerData","newCanvasData","setCanvasData","setCropBoxData","onRotateGranular","ev","newGranularAngle","Number","target","value","image","getImageData","scaleFactor","naturalWidth","naturalHeight","scaleFactorX","scaleX","prevCropboxData","storePrevCropboxData","bind","limitCropboxMovement","componentDidMount","opts","storeCropperInstance","imgElement","cropperOptions","addEventListener","componentWillUnmount","destroy","removeEventListener","getCropBoxData","event","cropboxData","detail","action","newCropboxData","renderGranularRotate","i18n","role","className","type","onInput","onChange","min","max","renderRevert","onClick","reset","setAspectRatio","initialAspectRatio","width","height","viewBox","d","fill","renderRotate","renderFlip","getData","renderZoomIn","zoom","renderZoomOut","renderCropSquare","renderCropWidescreen","renderCropWidescreenVertical","render","currentImage","actions","imageURL","URL","createObjectURL","data","alt","name","src","ref","revert","rotate","granularRotate","flip","zoomIn","zoomOut","cropSquare","cropWidescreen","cropWidescreenVertical"],"sources":["Editor.tsx"],"sourcesContent":["/* eslint-disable jsx-a11y/label-has-associated-control */\nimport Cropper from 'cropperjs'\nimport { h, Component } from 'preact'\nimport type { Meta, Body, UppyFile } from '@uppy/utils/lib/UppyFile'\nimport type { I18n } from '@uppy/utils/lib/Translator'\nimport getCanvasDataThatFitsPerfectlyIntoContainer from './utils/getCanvasDataThatFitsPerfectlyIntoContainer.ts'\nimport getScaleFactorThatRemovesDarkCorners from './utils/getScaleFactorThatRemovesDarkCorners.ts'\nimport limitCropboxMovementOnMove from './utils/limitCropboxMovementOnMove.ts'\nimport limitCropboxMovementOnResize from './utils/limitCropboxMovementOnResize.ts'\nimport type ImageEditor from './ImageEditor.ts'\n\ntype Props<M extends Meta, B extends Body> = {\n  currentImage: UppyFile<M, B>\n  storeCropperInstance: (cropper: Cropper) => void\n  opts: ImageEditor<M, B>['opts']\n  i18n: I18n\n  // eslint-disable-next-line react/no-unused-prop-types\n  save: () => void // eslint confused\n}\n\ntype State = {\n  angle90Deg: number\n  angleGranular: number\n  prevCropboxData: Cropper.CropBoxData | null\n}\n\nexport default class Editor<M extends Meta, B extends Body> extends Component<\n  Props<M, B>,\n  State\n> {\n  imgElement!: HTMLImageElement\n\n  cropper!: Cropper\n\n  constructor(props: Props<M, B>) {\n    super(props)\n    this.state = {\n      angle90Deg: 0,\n      angleGranular: 0,\n      prevCropboxData: null,\n    }\n    this.storePrevCropboxData = this.storePrevCropboxData.bind(this)\n    this.limitCropboxMovement = this.limitCropboxMovement.bind(this)\n  }\n\n  componentDidMount(): void {\n    const { opts, storeCropperInstance } = this.props\n    this.cropper = new Cropper(this.imgElement, opts.cropperOptions)\n\n    this.imgElement.addEventListener('cropstart', this.storePrevCropboxData)\n    // @ts-expect-error custom cropper event but DOM API does not understand\n    this.imgElement.addEventListener('cropend', this.limitCropboxMovement)\n\n    storeCropperInstance(this.cropper)\n  }\n\n  componentWillUnmount(): void {\n    this.cropper.destroy()\n\n    this.imgElement.removeEventListener('cropstart', this.storePrevCropboxData)\n    // @ts-expect-error custom cropper event but DOM API does not understand\n    this.imgElement.removeEventListener('cropend', this.limitCropboxMovement)\n  }\n\n  // eslint-disable-next-line react/sort-comp\n  storePrevCropboxData(): void {\n    this.setState({ prevCropboxData: this.cropper.getCropBoxData() })\n  }\n\n  limitCropboxMovement(event: { detail: { action: string } }): void {\n    const canvasData = this.cropper.getCanvasData()\n    const cropboxData = this.cropper.getCropBoxData()\n    const { prevCropboxData } = this.state\n\n    // 1. When we grab the cropbox in the middle and move it\n    if (event.detail.action === 'all') {\n      const newCropboxData = limitCropboxMovementOnMove(\n        canvasData,\n        cropboxData,\n        prevCropboxData!,\n      )\n      if (newCropboxData) this.cropper.setCropBoxData(newCropboxData)\n      // 2. When we stretch the cropbox by one of its sides\n    } else {\n      const newCropboxData = limitCropboxMovementOnResize(\n        canvasData,\n        cropboxData,\n        prevCropboxData!,\n      )\n      if (newCropboxData) this.cropper.setCropBoxData(newCropboxData)\n    }\n  }\n\n  onRotate90Deg = (): void => {\n    // 1. Set state\n    const { angle90Deg } = this.state\n    const newAngle = angle90Deg - 90\n    this.setState({\n      angle90Deg: newAngle,\n      angleGranular: 0,\n    })\n\n    // 2. Rotate the image\n    // Important to reset scale here, or cropper will get confused on further rotations\n    this.cropper.scale(1)\n    this.cropper.rotateTo(newAngle)\n\n    // 3. Fit the rotated image into the view\n    const canvasData = this.cropper.getCanvasData()\n    const containerData = this.cropper.getContainerData()\n    const newCanvasData = getCanvasDataThatFitsPerfectlyIntoContainer(\n      containerData,\n      canvasData,\n    )\n    this.cropper.setCanvasData(newCanvasData)\n\n    // 4. Make cropbox fully wrap the image\n    this.cropper.setCropBoxData(newCanvasData)\n  }\n\n  onRotateGranular = (ev: Event): void => {\n    // 1. Set state\n    const newGranularAngle = Number((ev.target as HTMLInputElement).value)\n    this.setState({ angleGranular: newGranularAngle })\n\n    // 2. Rotate the image\n    const { angle90Deg } = this.state\n    const newAngle = angle90Deg + newGranularAngle\n    this.cropper.rotateTo(newAngle)\n\n    // 3. Scale the image so that it fits into the cropbox\n    const image = this.cropper.getImageData()\n    const scaleFactor = getScaleFactorThatRemovesDarkCorners(\n      image.naturalWidth,\n      image.naturalHeight,\n      newGranularAngle,\n    )\n    // Preserve flip\n    const scaleFactorX =\n      this.cropper.getImageData().scaleX < 0 ? -scaleFactor : scaleFactor\n    this.cropper.scale(scaleFactorX, scaleFactor)\n  }\n\n  renderGranularRotate() {\n    const { i18n } = this.props\n    const { angleGranular } = this.state\n\n    return (\n      <label\n        role=\"tooltip\"\n        aria-label={`${angleGranular}ยบ`}\n        data-microtip-position=\"top\"\n        className=\"uppy-ImageCropper-rangeWrapper\"\n      >\n        <input\n          className=\"uppy-ImageCropper-range uppy-u-reset\"\n          type=\"range\"\n          onInput={this.onRotateGranular}\n          onChange={this.onRotateGranular}\n          value={angleGranular}\n          min=\"-45\"\n          max=\"45\"\n          aria-label={i18n('rotate')}\n        />\n      </label>\n    )\n  }\n\n  renderRevert() {\n    const { i18n, opts } = this.props\n\n    return (\n      <button\n        role=\"button tooltip\"\n        data-microtip-position=\"top\"\n        type=\"button\"\n        className=\"uppy-u-reset uppy-c-btn\"\n        aria-label={i18n('revert')}\n        onClick={() => {\n          this.cropper.reset()\n          this.cropper.setAspectRatio(\n            opts.cropperOptions.initialAspectRatio as number,\n          )\n          this.setState({ angle90Deg: 0, angleGranular: 0 })\n        }}\n      >\n        <svg\n          aria-hidden=\"true\"\n          className=\"uppy-c-icon\"\n          width=\"24\"\n          height=\"24\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n          <path d=\"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z\" />\n        </svg>\n      </button>\n    )\n  }\n\n  renderRotate() {\n    const { i18n } = this.props\n\n    return (\n      <button\n        role=\"button tooltip\"\n        data-microtip-position=\"top\"\n        type=\"button\"\n        className=\"uppy-u-reset uppy-c-btn\"\n        aria-label={i18n('rotate')}\n        onClick={this.onRotate90Deg}\n      >\n        <svg\n          aria-hidden=\"true\"\n          className=\"uppy-c-icon\"\n          width=\"24\"\n          height=\"24\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path d=\"M0 0h24v24H0V0zm0 0h24v24H0V0z\" fill=\"none\" />\n          <path d=\"M14 10a2 2 0 012 2v7a2 2 0 01-2 2H6a2 2 0 01-2-2v-7a2 2 0 012-2h8zm0 1.75H6a.25.25 0 00-.243.193L5.75 12v7a.25.25 0 00.193.243L6 19.25h8a.25.25 0 00.243-.193L14.25 19v-7a.25.25 0 00-.193-.243L14 11.75zM12 .76V4c2.3 0 4.61.88 6.36 2.64a8.95 8.95 0 012.634 6.025L21 13a1 1 0 01-1.993.117L19 13h-.003a6.979 6.979 0 00-2.047-4.95 6.97 6.97 0 00-4.652-2.044L12 6v3.24L7.76 5 12 .76z\" />\n        </svg>\n      </button>\n    )\n  }\n\n  renderFlip() {\n    const { i18n } = this.props\n\n    return (\n      <button\n        role=\"button tooltip\"\n        data-microtip-position=\"top\"\n        type=\"button\"\n        className=\"uppy-u-reset uppy-c-btn\"\n        aria-label={i18n('flipHorizontal')}\n        onClick={() =>\n          this.cropper.scaleX(-this.cropper.getData().scaleX || -1)\n        }\n      >\n        <svg\n          aria-hidden=\"true\"\n          className=\"uppy-c-icon\"\n          width=\"24\"\n          height=\"24\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n          <path d=\"M15 21h2v-2h-2v2zm4-12h2V7h-2v2zM3 5v14c0 1.1.9 2 2 2h4v-2H5V5h4V3H5c-1.1 0-2 .9-2 2zm16-2v2h2c0-1.1-.9-2-2-2zm-8 20h2V1h-2v22zm8-6h2v-2h-2v2zM15 5h2V3h-2v2zm4 8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2z\" />\n        </svg>\n      </button>\n    )\n  }\n\n  renderZoomIn() {\n    const { i18n } = this.props\n\n    return (\n      <button\n        role=\"button tooltip\"\n        data-microtip-position=\"top\"\n        type=\"button\"\n        className=\"uppy-u-reset uppy-c-btn\"\n        aria-label={i18n('zoomIn')}\n        onClick={() => this.cropper.zoom(0.1)}\n      >\n        <svg\n          aria-hidden=\"true\"\n          className=\"uppy-c-icon\"\n          height=\"24\"\n          viewBox=\"0 0 24 24\"\n          width=\"24\"\n        >\n          <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n          <path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\" />\n          <path d=\"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z\" />\n        </svg>\n      </button>\n    )\n  }\n\n  renderZoomOut() {\n    const { i18n } = this.props\n\n    return (\n      <button\n        role=\"button tooltip\"\n        data-microtip-position=\"top\"\n        type=\"button\"\n        className=\"uppy-u-reset uppy-c-btn\"\n        aria-label={i18n('zoomOut')}\n        onClick={() => this.cropper.zoom(-0.1)}\n      >\n        <svg\n          aria-hidden=\"true\"\n          className=\"uppy-c-icon\"\n          width=\"24\"\n          height=\"24\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n          <path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z\" />\n        </svg>\n      </button>\n    )\n  }\n\n  renderCropSquare() {\n    const { i18n } = this.props\n\n    return (\n      <button\n        role=\"button tooltip\"\n        data-microtip-position=\"top\"\n        type=\"button\"\n        className=\"uppy-u-reset uppy-c-btn\"\n        aria-label={i18n('aspectRatioSquare')}\n        onClick={() => this.cropper.setAspectRatio(1)}\n      >\n        <svg\n          aria-hidden=\"true\"\n          className=\"uppy-c-icon\"\n          width=\"24\"\n          height=\"24\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n          <path d=\"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\" />\n        </svg>\n      </button>\n    )\n  }\n\n  renderCropWidescreen() {\n    const { i18n } = this.props\n\n    return (\n      <button\n        role=\"button tooltip\"\n        data-microtip-position=\"top\"\n        type=\"button\"\n        className=\"uppy-u-reset uppy-c-btn\"\n        aria-label={i18n('aspectRatioLandscape')}\n        onClick={() => this.cropper.setAspectRatio(16 / 9)}\n      >\n        <svg\n          aria-hidden=\"true\"\n          className=\"uppy-c-icon\"\n          width=\"24\"\n          height=\"24\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path d=\"M 19,4.9999992 V 17.000001 H 4.9999998 V 6.9999992 H 19 m 0,-2 H 4.9999998 c -1.0999999,0 -1.9999999,0.9000001 -1.9999999,2 V 17.000001 c 0,1.1 0.9,2 1.9999999,2 H 19 c 1.1,0 2,-0.9 2,-2 V 6.9999992 c 0,-1.0999999 -0.9,-2 -2,-2 z\" />\n          <path fill=\"none\" d=\"M0 0h24v24H0z\" />\n        </svg>\n      </button>\n    )\n  }\n\n  renderCropWidescreenVertical() {\n    const { i18n } = this.props\n\n    return (\n      <button\n        role=\"button tooltip\"\n        data-microtip-position=\"top\"\n        type=\"button\"\n        aria-label={i18n('aspectRatioPortrait')}\n        className=\"uppy-u-reset uppy-c-btn\"\n        onClick={() => this.cropper.setAspectRatio(9 / 16)}\n      >\n        <svg\n          aria-hidden=\"true\"\n          className=\"uppy-c-icon\"\n          width=\"24\"\n          height=\"24\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path d=\"M 19.000001,19 H 6.999999 V 5 h 10.000002 v 14 m 2,0 V 5 c 0,-1.0999999 -0.9,-1.9999999 -2,-1.9999999 H 6.999999 c -1.1,0 -2,0.9 -2,1.9999999 v 14 c 0,1.1 0.9,2 2,2 h 10.000002 c 1.1,0 2,-0.9 2,-2 z\" />\n          <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n        </svg>\n      </button>\n    )\n  }\n\n  render() {\n    const { currentImage, opts } = this.props\n    const { actions } = opts\n    const imageURL = URL.createObjectURL(currentImage.data)\n\n    return (\n      <div className=\"uppy-ImageCropper\">\n        <div className=\"uppy-ImageCropper-container\">\n          <img\n            className=\"uppy-ImageCropper-image\"\n            alt={currentImage.name}\n            src={imageURL}\n            ref={(ref) => {\n              this.imgElement = ref as HTMLImageElement\n            }}\n          />\n        </div>\n\n        <div className=\"uppy-ImageCropper-controls\">\n          {actions.revert && this.renderRevert()}\n          {actions.rotate && this.renderRotate()}\n          {actions.granularRotate && this.renderGranularRotate()}\n          {actions.flip && this.renderFlip()}\n          {actions.zoomIn && this.renderZoomIn()}\n          {actions.zoomOut && this.renderZoomOut()}\n          {actions.cropSquare && this.renderCropSquare()}\n          {actions.cropWidescreen && this.renderCropWidescreen()}\n          {actions.cropWidescreenVertical &&\n            this.renderCropWidescreenVertical()}\n        </div>\n      </div>\n    )\n  }\n}\n"],"mappings":"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","ignoreList":[]}